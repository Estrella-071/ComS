
:root {
  --bg-color: #f4f1ea;
  --bg-translucent: rgba(244, 241, 234, 0.85); /* Increased opacity for better readability on mobile */
  
  --text-primary: #292524;
  --text-secondary: #57534e;
  --text-subtle: #a8a29e;

  --accent-text: #1c1917;
  --accent-bg: rgba(0, 0, 0, 0.05);
  --accent-solid: #1c1917;
  --accent-solid-text: #f4f1ea;
  --accent-solid-hover: #44403c;

  --ui-bg: rgba(255, 255, 255, 0.6);
  --ui-bg-hover: rgba(0, 0, 0, 0.05);
  --ui-border: rgba(0, 0, 0, 0.08);

  --success-bg: rgba(34, 197, 94, 0.15);
  --success-border: rgba(34, 197, 94, 0.4);
  --success-text: #15803d;
  --success-solid-bg: #16a34a;
  --success-solid-text: #ffffff;

  --error-bg: rgba(239, 68, 68, 0.15);
  --error-border: rgba(239, 68, 68, 0.4);
  --error-text: #b91c1c;
  --error-solid-bg: #ef4444;
  --error-solid-text: #ffffff;

  --warning-text: #b45309;
  --warning-text-hover: #d97706;
  --warning-solid-bg: #f59e0b;
  --warning-solid-text: #ffffff;
  
  --z-background: -1;
  --z-base: 1;
  --z-content-overlay: 10;
  --z-sticky-l1: 15;
  --z-sticky-l2: 16;
  --z-mobile-nav: 30;
  --z-sidebar-backdrop: 40;
  --z-sidebar: 41;
  --z-fab: 50;
  --z-modal-backdrop: 60;
  --z-modal-content: 61;
  --z-tooltip: 100;
}

html.dark {
  --bg-color: #0c0a09;
  --bg-translucent: rgba(12, 10, 9, 0.85);
  
  --text-primary: #e7e5e4;
  --text-secondary: #a8a29e;
  --text-subtle: #57534e;

  --accent-text: #e7e5e4;
  --accent-bg: rgba(255, 255, 255, 0.08);
  --accent-solid: #fafaf9;
  --accent-solid-text: #0c0a09;
  --accent-solid-hover: #d6d3d1;

  --ui-bg: rgba(255, 255, 255, 0.05);
  --ui-bg-hover: rgba(255, 255, 255, 0.1);
  --ui-border: rgba(255, 255, 255, 0.12);

  --success-bg: rgba(74, 222, 128, 0.1);
  --success-border: rgba(74, 222, 128, 0.3);
  --success-text: #4ade80;
  --success-solid-bg: #22c55e;
  --success-solid-text: #f0fdf4;

  --error-bg: rgba(248, 113, 113, 0.1);
  --error-border: rgba(248, 113, 113, 0.3);
  --error-text: #f87171;
  --error-solid-bg: #f87171;
  --error-solid-text: #7f1d1d;

  --warning-text: #fcd34d;
  --warning-text-hover: #fde047;
  --warning-solid-bg: #fcd34d;
  --warning-solid-text: #78350f;
}

html {
  scroll-behavior: smooth;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* 
   Fluid Typography / Density Control - UPDATED
   Critically important for fixing "oversized" elements on mobile.
*/

/* Mobile (Small phones) */
@media (max-width: 639px) {
  html {
    font-size: 14px; /* Scaling down base size shrinks rem-based buttons/padding */
  }
}

/* Tablet (Portrait) */
@media (min-width: 640px) and (max-width: 1023px) {
  html {
    font-size: 15px;
  }
}

/* Desktop */
@media (min-width: 1024px) {
  html {
    font-size: 16px;
  }
}

/* Large Screens */
@media (min-width: 2000px) {
  html {
    font-size: 18px;
  }
}

body {
  font-family: 'Noto Serif', 'Noto Serif TC', serif;
  transition: background-color 0.5s ease-in-out, color 0.5s ease-in-out;
  background-color: var(--bg-color);
  color: var(--text-primary);
  overflow: hidden; /* Prevent body scroll, handle in containers */
}

button, input, optgroup, select, textarea {
  font-family: inherit;
}

code, pre, .font-mono, textarea {
  font-family: 'JetBrains Mono', monospace !important;
}

#background-canvas {
  position: fixed;
  inset: 0;
  z-index: 0;
  pointer-events: none;
}

#root {
  position: relative;
  z-index: 1;
  height: 100%;
}

.glass-pane {
  background-color: var(--bg-translucent);
  border: 1px solid var(--ui-border);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  backdrop-filter: blur(20px) saturate(180%);
  box-shadow: 
    0 4px 6px -1px rgba(0, 0, 0, 0.02),
    0 10px 15px -3px rgba(0, 0, 0, 0.02),
    0 0 0 1px rgba(255, 255, 255, 0.05) inset;
  transition: border-color 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease;
  transform: translateZ(0); 
}

html.dark .glass-pane {
  box-shadow: 
    0 8px 32px rgba(0, 0, 0, 0.4),
    0 0 0 1px rgba(255, 255, 255, 0.05) inset;
  border-top: 1px solid rgba(255,255,255,0.05);
}

.glass-pane:hover {
  border-color: var(--text-subtle);
}

.prose {
  line-height: var(--prose-line-height, 1.8);
  color: var(--text-secondary);
}

/* Mobile optimizations for prose */
@media (max-width: 640px) {
  .prose p { margin-top: 1em; margin-bottom: 1em; }
  .prose h1 { margin-top: 2em; margin-bottom: 1em; font-size: 2em; }
  .prose h2 { margin-top: 1.5em; font-size: 1.5em; }
  .prose h3 { margin-top: 1.25em; font-size: 1.25em; }
  .prose pre { padding: 1em; margin: 1.5em 0; }
}

.en-translation {
  position: relative;
  padding-left: 1rem;
  margin-top: 0.5em;
  margin-bottom: 2em;
  color: var(--text-secondary);
  font-size: 0.95em;
  line-height: 1.6;
  opacity: 0.9;
  border-left: 2px solid var(--ui-border);
}

::-webkit-scrollbar {
  width: 5px;
  height: 5px;
}
::-webkit-scrollbar-track {
  background: transparent;
}
::-webkit-scrollbar-thumb {
  background-color: var(--ui-border);
  border-radius: 99px;
}
::-webkit-scrollbar-thumb:hover {
  background-color: var(--text-subtle);
}

/* Fix sticky hover effects on touch devices */
@media (hover: none) {
  .glass-pane:hover { border-color: var(--ui-border); }
  button:hover { transform: none !important; }
}
